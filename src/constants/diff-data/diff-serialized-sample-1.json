[
  {
    "status": "MODIFIED",
    "displayPaths": ["upscale/utilities/utils.py"],
    "oldPath": "upscale/utilities/utils.py",
    "newPath": "upscale/utilities/utils.py",
    "hunks": [
      {
        "enclosingBlock": "def get_sms_translation(template_type):",
        "oldLineCount": 7,
        "oldLineStart": 368,
        "newLineCount": 7,
        "newLineStart": 368,
        "beforeDiff": [
          {
            "parts": [
              { "content": "def ", "status": "UNCHANGED" },
              { "content": "get_shorten_url(url):", "status": "REMOVED" }
            ],
            "oldN": 371,
            "newN": 371
          }
        ],
        "afterDiff": [
          {
            "parts": [
              { "content": "def ", "status": "UNCHANGED" },
              {
                "content": "get_shorten_url(url: str) -> str:",
                "status": "ADDED"
              }
            ],
            "oldN": 371,
            "newN": 371
          }
        ]
      }
    ]
  },
  {
    "status": "MODIFIED",
    "displayPaths": ["upscale/v2/core/domain/__init__.py"],
    "oldPath": "upscale/v2/core/domain/__init__.py",
    "newPath": "upscale/v2/core/domain/__init__.py",
    "hunks": [
      {
        "enclosingBlock": "from .base import (",
        "oldLineCount": 7,
        "oldLineStart": 9,
        "newLineCount": 12,
        "newLineStart": 9,
        "beforeDiff": [
          {
            "parts": [
              { "content": "    ", "status": "UNCHANGED" },
              { "content": "sanitize_phone", "status": "REMOVED" }
            ],
            "oldN": 15,
            "newN": 15
          }
        ],
        "afterDiff": [
          {
            "parts": [
              { "content": "from .services import ", "status": "UNCHANGED" },
              { "content": "(", "status": "ADDED" }
            ],
            "oldN": 12,
            "newN": 12
          },
          {
            "parts": [
              { "content": "    ", "status": "UNCHANGED" },
              { "content": "sanitize_phone,", "status": "ADDED" }
            ],
            "oldN": 15,
            "newN": 15
          },
          {
            "parts": [{ "content": "    validate_email,", "status": "ADDED" }],
            "oldN": 16,
            "newN": 16
          },
          {
            "parts": [{ "content": ")", "status": "ADDED" }],
            "oldN": 17,
            "newN": 17
          }
        ]
      },
      {
        "enclosingBlock": "__all__ = [",
        "oldLineCount": 5,
        "oldLineStart": 30,
        "newLineCount": 6,
        "newLineStart": 35,
        "beforeDiff": [],
        "afterDiff": [
          {
            "parts": [
              { "content": "    ", "status": "UNCHANGED" },
              { "content": "\"validate_email\",", "status": "ADDED" }
            ],
            "oldN": 33,
            "newN": 38
          }
        ]
      }
    ]
  },
  {
    "status": "MODIFIED",
    "displayPaths": ["upscale/v2/core/domain/services/__init__.py"],
    "oldPath": "upscale/v2/core/domain/services/__init__.py",
    "newPath": "upscale/v2/core/domain/services/__init__.py",
    "hunks": [
      {
        "oldLineCount": 4,
        "oldLineStart": 1,
        "newLineCount": 10,
        "newLineStart": 1,
        "beforeDiff": [
          {
            "parts": [
              { "content": "__all__ = ", "status": "UNCHANGED" },
              { "content": "[\"get_app_version\",", "status": "REMOVED" }
            ],
            "oldN": 5,
            "newN": 5
          },
          {
            "parts": [
              { "content": "    ", "status": "UNCHANGED" },
              { "content": "\"sanitize_phone\"]", "status": "REMOVED" }
            ],
            "oldN": 8,
            "newN": 8
          }
        ],
        "afterDiff": [
          {
            "parts": [
              {
                "content": "from .email import validate_email",
                "status": "ADDED"
              }
            ],
            "oldN": 1,
            "newN": 1
          },
          {
            "parts": [
              { "content": "__all__ = ", "status": "UNCHANGED" },
              { "content": "[", "status": "ADDED" }
            ],
            "oldN": 5,
            "newN": 5
          },
          {
            "parts": [
              { "content": "    \"get_app_version\",", "status": "ADDED" }
            ],
            "oldN": 6,
            "newN": 6
          },
          {
            "parts": [
              { "content": "    ", "status": "UNCHANGED" },
              { "content": "\"sanitize_phone\",", "status": "ADDED" }
            ],
            "oldN": 8,
            "newN": 8
          },
          {
            "parts": [
              { "content": "    \"validate_email\",", "status": "ADDED" }
            ],
            "oldN": 9,
            "newN": 9
          },
          {
            "parts": [{ "content": "]", "status": "ADDED" }],
            "oldN": 10,
            "newN": 10
          }
        ]
      }
    ]
  },
  {
    "status": "MODIFIED",
    "displayPaths": ["upscale/v2/modules/user/bootstrap.py"],
    "oldPath": "upscale/v2/modules/user/bootstrap.py",
    "newPath": "upscale/v2/modules/user/bootstrap.py",
    "hunks": [
      {
        "oldLineCount": 5,
        "oldLineStart": 1,
        "newLineCount": 7,
        "newLineStart": 1,
        "beforeDiff": [],
        "afterDiff": [
          {
            "parts": [
              {
                "content": "from upscale.utilities.utils import get_shorten_url",
                "status": "ADDED"
              }
            ],
            "oldN": 1,
            "newN": 1
          },
          {
            "parts": [
              {
                "content": "from upscale.v2.aws.sns import SnsProvider",
                "status": "ADDED"
              }
            ],
            "oldN": 4,
            "newN": 4
          }
        ]
      },
      {
        "enclosingBlock": "def bootstrap() -> UserService:",
        "oldLineCount": 8,
        "oldLineStart": 20,
        "newLineCount": 10,
        "newLineStart": 22,
        "beforeDiff": [],
        "afterDiff": [
          {
            "parts": [
              { "content": "        ", "status": "UNCHANGED" },
              { "content": "sns_provider=SnsProvider(),", "status": "ADDED" }
            ],
            "oldN": 23,
            "newN": 25
          },
          {
            "parts": [
              { "content": "        ", "status": "UNCHANGED" },
              { "content": "url_shortener=get_shorten_url,", "status": "ADDED" }
            ],
            "oldN": 26,
            "newN": 28
          }
        ]
      }
    ]
  },
  {
    "status": "MODIFIED",
    "displayPaths": ["upscale/v2/modules/user/domain/entities/user.py"],
    "oldPath": "upscale/v2/modules/user/domain/entities/user.py",
    "newPath": "upscale/v2/modules/user/domain/entities/user.py",
    "hunks": [
      {
        "enclosingBlock": "from upscale.v2.core.domain import (",
        "oldLineCount": 6,
        "oldLineStart": 11,
        "newLineCount": 7,
        "newLineStart": 11,
        "beforeDiff": [],
        "afterDiff": [
          {
            "parts": [
              { "content": "    ", "status": "UNCHANGED" },
              { "content": "validate_email,", "status": "ADDED" }
            ],
            "oldN": 14,
            "newN": 14
          }
        ]
      },
      {
        "enclosingBlock": "from upscale.v2.modules.user.domain.enums import (",
        "oldLineCount": 7,
        "oldLineStart": 22,
        "newLineCount": 7,
        "newLineStart": 23,
        "beforeDiff": [
          {
            "parts": [
              {
                "content": "from upscale.v2.modules.user.errors import ",
                "status": "UNCHANGED"
              },
              { "content": "CreateUserErrors", "status": "REMOVED" }
            ],
            "oldN": 25,
            "newN": 26
          }
        ],
        "afterDiff": [
          {
            "parts": [
              {
                "content": "from upscale.v2.modules.user.errors import ",
                "status": "UNCHANGED"
              },
              { "content": "PutUserErrors", "status": "ADDED" }
            ],
            "oldN": 25,
            "newN": 26
          }
        ]
      },
      {
        "enclosingBlock": "class User(DomainEntity):",
        "oldLineCount": 29,
        "oldLineStart": 125,
        "newLineCount": 39,
        "newLineStart": 126,
        "beforeDiff": [
          {
            "parts": [
              { "content": "                raise ", "status": "UNCHANGED" },
              {
                "content": "UpsException(CreateUserErrors.INVALID_PHONE)",
                "status": "REMOVED"
              }
            ],
            "oldN": 136,
            "newN": 137
          },
          {
            "parts": [
              { "content": "                raise ", "status": "UNCHANGED" },
              {
                "content": "UpsException(CreateUserErrors.INVALID_SECONDARY_PHONE)",
                "status": "REMOVED"
              }
            ],
            "oldN": 142,
            "newN": 143
          },
          {
            "parts": [
              { "content": "                raise ", "status": "UNCHANGED" },
              {
                "content": "UpsException(CreateUserErrors.INVALID_WHATSAPP_ID)",
                "status": "REMOVED"
              }
            ],
            "oldN": 149,
            "newN": 150
          }
        ],
        "afterDiff": [
          {
            "parts": [
              { "content": "        ", "status": "UNCHANGED" },
              {
                "content": "if email is None and username is None and phone is None:",
                "status": "ADDED"
              }
            ],
            "oldN": 129,
            "newN": 130
          },
          {
            "parts": [
              {
                "content": "            raise UpsException(PutUserErrors.USERNAME_REQUIRED)",
                "status": "ADDED"
              }
            ],
            "oldN": 130,
            "newN": 131
          },
          {
            "parts": [
              { "content": "                raise ", "status": "UNCHANGED" },
              {
                "content": "UpsException(PutUserErrors.INVALID_PHONE)",
                "status": "ADDED"
              }
            ],
            "oldN": 136,
            "newN": 137
          },
          {
            "parts": [
              { "content": "                raise ", "status": "UNCHANGED" },
              {
                "content": "UpsException(PutUserErrors.INVALID_SECONDARY_PHONE)",
                "status": "ADDED"
              }
            ],
            "oldN": 142,
            "newN": 143
          },
          {
            "parts": [
              { "content": "                raise ", "status": "UNCHANGED" },
              {
                "content": "UpsException(PutUserErrors.INVALID_WHATSAPP_ID)",
                "status": "ADDED"
              }
            ],
            "oldN": 149,
            "newN": 150
          },
          {
            "parts": [
              { "content": "        ", "status": "UNCHANGED" },
              { "content": "validated_email = None", "status": "ADDED" }
            ],
            "oldN": 155,
            "newN": 156
          },
          {
            "parts": [{ "content": "        if email:", "status": "ADDED" }],
            "oldN": 156,
            "newN": 157
          },
          {
            "parts": [
              {
                "content": "            validated_email = validate_email(email)",
                "status": "ADDED"
              }
            ],
            "oldN": 157,
            "newN": 158
          },
          {
            "parts": [
              {
                "content": "            if validated_email is None:",
                "status": "ADDED"
              }
            ],
            "oldN": 158,
            "newN": 159
          },
          {
            "parts": [
              {
                "content": "                raise UpsException(PutUserErrors.INVALID_EMAIL)",
                "status": "ADDED"
              }
            ],
            "oldN": 159,
            "newN": 160
          }
        ]
      },
      {
        "enclosingBlock": "class User(DomainEntity):",
        "oldLineCount": 7,
        "oldLineStart": 160,
        "newLineCount": 7,
        "newLineStart": 171,
        "beforeDiff": [
          {
            "parts": [
              { "content": "            raise ", "status": "UNCHANGED" },
              {
                "content": "UpsException(CreateUserErrors.NOT_ONE_DEFAULT_LANG_PROFILE)",
                "status": "REMOVED"
              }
            ],
            "oldN": 163,
            "newN": 174
          }
        ],
        "afterDiff": [
          {
            "parts": [
              { "content": "            raise ", "status": "UNCHANGED" },
              {
                "content": "UpsException(PutUserErrors.NOT_ONE_DEFAULT_LANG_PROFILE)",
                "status": "ADDED"
              }
            ],
            "oldN": 163,
            "newN": 174
          }
        ]
      },
      {
        "enclosingBlock": "class User(DomainEntity):",
        "oldLineCount": 7,
        "oldLineStart": 173,
        "newLineCount": 7,
        "newLineStart": 184,
        "beforeDiff": [
          {
            "parts": [
              { "content": "            ", "status": "UNCHANGED" },
              {
                "content": "email=email.lower() if email else None,",
                "status": "REMOVED"
              }
            ],
            "oldN": 176,
            "newN": 187
          }
        ],
        "afterDiff": [
          {
            "parts": [
              { "content": "            ", "status": "UNCHANGED" },
              { "content": "email=validated_email,", "status": "ADDED" }
            ],
            "oldN": 176,
            "newN": 187
          }
        ]
      },
      {
        "enclosingBlock": "class User(DomainEntity):",
        "oldLineCount": 6,
        "oldLineStart": 196,
        "newLineCount": 36,
        "newLineStart": 207,
        "beforeDiff": [],
        "afterDiff": [
          {
            "parts": [
              { "content": "    ", "status": "UNCHANGED" },
              { "content": "def update(", "status": "ADDED" }
            ],
            "oldN": 199,
            "newN": 210
          },
          {
            "parts": [{ "content": "        self,", "status": "ADDED" }],
            "oldN": 200,
            "newN": 211
          },
          {
            "parts": [
              {
                "content": "        address: Address | None,",
                "status": "ADDED"
              }
            ],
            "oldN": 201,
            "newN": 212
          },
          {
            "parts": [
              { "content": "        avatar_id: str | None,", "status": "ADDED" }
            ],
            "oldN": 202,
            "newN": 213
          },
          {
            "parts": [
              { "content": "        branch: Branch | None,", "status": "ADDED" }
            ],
            "oldN": 203,
            "newN": 214
          },
          {
            "parts": [
              {
                "content": "        contact_order: list[ContactChannel],",
                "status": "ADDED"
              }
            ],
            "oldN": 204,
            "newN": 215
          },
          {
            "parts": [
              { "content": "        email: str | None,", "status": "ADDED" }
            ],
            "oldN": 205,
            "newN": 216
          },
          {
            "parts": [
              {
                "content": "        localized_profiles: list[UserLocalizedProfile],",
                "status": "ADDED"
              }
            ],
            "oldN": 206,
            "newN": 217
          },
          {
            "parts": [
              {
                "content": "        personal_intro_id: str | None,",
                "status": "ADDED"
              }
            ],
            "oldN": 207,
            "newN": 218
          },
          {
            "parts": [
              { "content": "        phone: str | None,", "status": "ADDED" }
            ],
            "oldN": 208,
            "newN": 219
          },
          {
            "parts": [
              {
                "content": "        qualifications: str | None,",
                "status": "ADDED"
              }
            ],
            "oldN": 209,
            "newN": 220
          },
          {
            "parts": [{ "content": "        role: Role,", "status": "ADDED" }],
            "oldN": 210,
            "newN": 221
          },
          {
            "parts": [
              {
                "content": "        secondary_email: str | None,",
                "status": "ADDED"
              }
            ],
            "oldN": 211,
            "newN": 222
          },
          {
            "parts": [
              {
                "content": "        secondary_phones: list[str],",
                "status": "ADDED"
              }
            ],
            "oldN": 212,
            "newN": 223
          },
          {
            "parts": [
              { "content": "        socials: UserSocials,", "status": "ADDED" }
            ],
            "oldN": 213,
            "newN": 224
          },
          {
            "parts": [
              { "content": "        status: bool,", "status": "ADDED" }
            ],
            "oldN": 214,
            "newN": 225
          },
          {
            "parts": [
              { "content": "        team: Team | None,", "status": "ADDED" }
            ],
            "oldN": 215,
            "newN": 226
          },
          {
            "parts": [
              {
                "content": "        temp_password: str | None,",
                "status": "ADDED"
              }
            ],
            "oldN": 216,
            "newN": 227
          },
          {
            "parts": [
              { "content": "        username: str | None,", "status": "ADDED" }
            ],
            "oldN": 217,
            "newN": 228
          },
          {
            "parts": [{ "content": "    ) -> \"User\":", "status": "ADDED" }],
            "oldN": 218,
            "newN": 229
          },
          {
            "parts": [
              {
                "content": "        if email is None and username is None and phone is None:",
                "status": "ADDED"
              }
            ],
            "oldN": 219,
            "newN": 230
          },
          {
            "parts": [
              {
                "content": "            raise UpsException(PutUserErrors.USERNAME_REQUIRED)",
                "status": "ADDED"
              }
            ],
            "oldN": 220,
            "newN": 231
          },
          {
            "parts": [
              { "content": "        phone_number = None", "status": "ADDED" }
            ],
            "oldN": 222,
            "newN": 233
          },
          {
            "parts": [
              {
                "content": "        if phone is not None and phone != self.phone:",
                "status": "ADDED"
              }
            ],
            "oldN": 223,
            "newN": 234
          },
          {
            "parts": [
              {
                "content": "            phone_number = sanitize_phone(phone)",
                "status": "ADDED"
              }
            ],
            "oldN": 224,
            "newN": 235
          },
          {
            "parts": [
              {
                "content": "            if phone_number is None:",
                "status": "ADDED"
              }
            ],
            "oldN": 225,
            "newN": 236
          },
          {
            "parts": [
              {
                "content": "                raise UpsException(PutUserErrors.INVALID_PHONE)",
                "status": "ADDED"
              }
            ],
            "oldN": 226,
            "newN": 237
          },
          {
            "parts": [{ "content": "        return self", "status": "ADDED" }],
            "oldN": 227,
            "newN": 238
          }
        ]
      }
    ]
  },
  {
    "status": "MODIFIED",
    "displayPaths": ["upscale/v2/modules/user/errors/__init__.py"],
    "oldPath": "upscale/v2/modules/user/errors/__init__.py",
    "newPath": "upscale/v2/modules/user/errors/__init__.py",
    "hunks": [
      {
        "oldLineCount": 3,
        "oldLineStart": 1,
        "newLineCount": 3,
        "newLineStart": 1,
        "beforeDiff": [
          {
            "parts": [
              { "content": "from ", "status": "UNCHANGED" },
              { "content": ".create_user", "status": "REMOVED" },
              { "content": " import ", "status": "UNCHANGED" },
              { "content": "CreateUserErrors", "status": "REMOVED" }
            ],
            "oldN": 1,
            "newN": 1
          },
          {
            "parts": [
              { "content": "__all__ = ", "status": "UNCHANGED" },
              { "content": "[\"CreateUserErrors\"]", "status": "REMOVED" }
            ],
            "oldN": 3,
            "newN": 3
          }
        ],
        "afterDiff": [
          {
            "parts": [
              { "content": "from ", "status": "UNCHANGED" },
              { "content": ".put_user", "status": "ADDED" },
              { "content": " import ", "status": "UNCHANGED" },
              { "content": "PutUserErrors", "status": "ADDED" }
            ],
            "oldN": 1,
            "newN": 1
          },
          {
            "parts": [
              { "content": "__all__ = ", "status": "UNCHANGED" },
              { "content": "[\"PutUserErrors\"]", "status": "ADDED" }
            ],
            "oldN": 3,
            "newN": 3
          }
        ]
      }
    ]
  },
  {
    "status": "REMOVED",
    "displayPaths": ["upscale/v2/modules/user/errors/create_user.py"],
    "oldPath": "upscale/v2/modules/user/errors/create_user.py",
    "newPath": null,
    "hunks": [
      {
        "oldLineCount": 37,
        "oldLineStart": 1,
        "newLineCount": 0,
        "newLineStart": 0,
        "beforeDiff": [
          {
            "parts": [
              {
                "content": "from upscale.v2.core.domain import DescribedStrEnum",
                "status": "REMOVED"
              }
            ],
            "oldN": 1,
            "newN": 0
          },
          {
            "parts": [
              {
                "content": "class CreateUserErrors(DescribedStrEnum):",
                "status": "REMOVED"
              }
            ],
            "oldN": 4,
            "newN": 3
          },
          {
            "parts": [
              { "content": "    UNAUTHORIZED = (", "status": "REMOVED" }
            ],
            "oldN": 5,
            "newN": 4
          },
          {
            "parts": [
              { "content": "        \"UNAUTHORIZED\",", "status": "REMOVED" }
            ],
            "oldN": 6,
            "newN": 5
          },
          {
            "parts": [
              {
                "content": "        \"User isn't authorized to create user in other branch\",",
                "status": "REMOVED"
              }
            ],
            "oldN": 7,
            "newN": 6
          },
          {
            "parts": [{ "content": "    )", "status": "REMOVED" }],
            "oldN": 8,
            "newN": 7
          },
          {
            "parts": [
              { "content": "    USERNAME_TAKEN = (", "status": "REMOVED" }
            ],
            "oldN": 9,
            "newN": 8
          },
          {
            "parts": [
              {
                "content": "        \"EMAIL_PHONE_OR_USER_NAME_TAKEN\",",
                "status": "REMOVED"
              }
            ],
            "oldN": 10,
            "newN": 9
          },
          {
            "parts": [
              {
                "content": "        \"Email, phone or username already in use\",",
                "status": "REMOVED"
              }
            ],
            "oldN": 11,
            "newN": 10
          },
          {
            "parts": [{ "content": "    )", "status": "REMOVED" }],
            "oldN": 12,
            "newN": 11
          },
          {
            "parts": [
              { "content": "    USERNAME_REQUIRED = (", "status": "REMOVED" }
            ],
            "oldN": 13,
            "newN": 12
          },
          {
            "parts": [
              {
                "content": "        \"USERNAME_REQUIRED\",",
                "status": "REMOVED"
              }
            ],
            "oldN": 14,
            "newN": 13
          },
          {
            "parts": [
              {
                "content": "        \"One of email, username or phone is required\",",
                "status": "REMOVED"
              }
            ],
            "oldN": 15,
            "newN": 14
          },
          {
            "parts": [{ "content": "    )", "status": "REMOVED" }],
            "oldN": 16,
            "newN": 15
          },
          {
            "parts": [
              {
                "content": "    USERNAME_TAKEN_IN_OTHER_ORG = (",
                "status": "REMOVED"
              }
            ],
            "oldN": 17,
            "newN": 16
          },
          {
            "parts": [
              {
                "content": "        \"USERNAME_TAKEN_IN_OTHER_ORG\",",
                "status": "REMOVED"
              }
            ],
            "oldN": 18,
            "newN": 17
          },
          {
            "parts": [
              {
                "content": "        \"Email, phone or username already in use in another organization\",",
                "status": "REMOVED"
              }
            ],
            "oldN": 19,
            "newN": 18
          },
          {
            "parts": [{ "content": "    )", "status": "REMOVED" }],
            "oldN": 20,
            "newN": 19
          },
          {
            "parts": [
              { "content": "    INVALID_PASSWORD = (", "status": "REMOVED" }
            ],
            "oldN": 21,
            "newN": 20
          },
          {
            "parts": [
              {
                "content": "        \"INVALID_PASSWORD\",",
                "status": "REMOVED"
              }
            ],
            "oldN": 22,
            "newN": 21
          },
          {
            "parts": [
              {
                "content": "        \"Password must be 8 characters long, include an upper-case character and one digit\",",
                "status": "REMOVED"
              }
            ],
            "oldN": 23,
            "newN": 22
          },
          {
            "parts": [{ "content": "    )", "status": "REMOVED" }],
            "oldN": 24,
            "newN": 23
          },
          {
            "parts": [
              {
                "content": "    INVALID_PHONE = (\"INVALID_PHONE\", \"Provided phone number is invalid\")",
                "status": "REMOVED"
              }
            ],
            "oldN": 25,
            "newN": 24
          },
          {
            "parts": [
              {
                "content": "    INVALID_SECONDARY_PHONE = (",
                "status": "REMOVED"
              }
            ],
            "oldN": 26,
            "newN": 25
          },
          {
            "parts": [
              {
                "content": "        \"INVALID_SECONDARY_PHONE\",",
                "status": "REMOVED"
              }
            ],
            "oldN": 27,
            "newN": 26
          },
          {
            "parts": [
              {
                "content": "        \"One of the provided secondary phones isn't a valid phone number\",",
                "status": "REMOVED"
              }
            ],
            "oldN": 28,
            "newN": 27
          },
          {
            "parts": [{ "content": "    )", "status": "REMOVED" }],
            "oldN": 29,
            "newN": 28
          },
          {
            "parts": [
              { "content": "    INVALID_WHATSAPP_ID = (", "status": "REMOVED" }
            ],
            "oldN": 30,
            "newN": 29
          },
          {
            "parts": [
              {
                "content": "        \"INVALID_WHATSAPP_ID\",",
                "status": "REMOVED"
              }
            ],
            "oldN": 31,
            "newN": 30
          },
          {
            "parts": [
              {
                "content": "        \"Provided whatsapp ID isn't a valid phone number\",",
                "status": "REMOVED"
              }
            ],
            "oldN": 32,
            "newN": 31
          },
          {
            "parts": [{ "content": "    )", "status": "REMOVED" }],
            "oldN": 33,
            "newN": 32
          },
          {
            "parts": [
              {
                "content": "    NOT_ONE_DEFAULT_LANG_PROFILE = (",
                "status": "REMOVED"
              }
            ],
            "oldN": 34,
            "newN": 33
          },
          {
            "parts": [
              {
                "content": "        \"NO_DEFAULT_LANG_PROFILE\",",
                "status": "REMOVED"
              }
            ],
            "oldN": 35,
            "newN": 34
          },
          {
            "parts": [
              {
                "content": "        \"Provided multiLanguageProfiles must have exactly one profile with `isDefaultLanguage: true`\",",
                "status": "REMOVED"
              }
            ],
            "oldN": 36,
            "newN": 35
          },
          {
            "parts": [{ "content": "    )", "status": "REMOVED" }],
            "oldN": 37,
            "newN": 36
          }
        ],
        "afterDiff": []
      }
    ]
  },
  {
    "status": "MODIFIED",
    "displayPaths": ["upscale/v2/modules/user/inputs/update_user.py"],
    "oldPath": "upscale/v2/modules/user/inputs/update_user.py",
    "newPath": "upscale/v2/modules/user/inputs/update_user.py",
    "hunks": [
      {
        "oldLineCount": 18,
        "oldLineStart": 1,
        "newLineCount": 55,
        "newLineStart": 1,
        "beforeDiff": [
          {
            "parts": [
              {
                "content": " upscale.v2.core.scalars import ",
                "status": "UNCHANGED"
              },
              { "content": "UpscaleID", "status": "REMOVED" }
            ],
            "oldN": 7,
            "newN": 7
          },
          {
            "parts": [
              { "content": "    ", "status": "UNCHANGED" },
              { "content": "RoleNameEnum", "status": "REMOVED" }
            ],
            "oldN": 10,
            "newN": 10
          },
          {
            "parts": [
              { "content": "from ", "status": "UNCHANGED" },
              {
                "content": "upscale.v2.modules.user.inputs.base",
                "status": "REMOVED"
              },
              { "content": " import ", "status": "UNCHANGED" },
              { "content": "BaseUserInput", "status": "REMOVED" }
            ],
            "oldN": 13,
            "newN": 13
          },
          {
            "parts": [
              { "content": "class ", "status": "UNCHANGED" },
              {
                "content": "UpdateUserInput(BaseUserInput):",
                "status": "REMOVED"
              }
            ],
            "oldN": 22,
            "newN": 22
          }
        ],
        "afterDiff": [
          {
            "parts": [
              {
                "content": "from pydash import objects  ",
                "status": "UNCHANGED"
              },
              { "content": "# type: ignore", "status": "ADDED" }
            ],
            "oldN": 2,
            "newN": 2
          },
          {
            "parts": [
              {
                "content": "from upscale.v2.core.enums import ",
                "status": "UNCHANGED"
              },
              { "content": "ContactOrderValues,", "status": "ADDED" },
              { "content": " StatusEnum", "status": "UNCHANGED" }
            ],
            "oldN": 4,
            "newN": 4
          },
          {
            "parts": [
              { "content": "from ", "status": "UNCHANGED" },
              {
                "content": "upscale.v2.core.inputs import AddressInput",
                "status": "ADDED"
              }
            ],
            "oldN": 6,
            "newN": 6
          },
          {
            "parts": [
              { "content": "from", "status": "ADDED" },
              {
                "content": " upscale.v2.core.scalars import ",
                "status": "UNCHANGED"
              },
              {
                "content": "UpscaleEmail, UpscaleID, UpscalePhone",
                "status": "ADDED"
              }
            ],
            "oldN": 7,
            "newN": 7
          },
          {
            "parts": [
              {
                "content": "from upscale.v2.modules.user.constants import ",
                "status": "UNCHANGED"
              },
              { "content": "(", "status": "ADDED" }
            ],
            "oldN": 8,
            "newN": 8
          },
          {
            "parts": [
              { "content": "    ", "status": "UNCHANGED" },
              { "content": "DEFAULT_CONTACT_ORDER,", "status": "ADDED" }
            ],
            "oldN": 10,
            "newN": 10
          },
          {
            "parts": [{ "content": "    RoleNameEnum,", "status": "ADDED" }],
            "oldN": 11,
            "newN": 11
          },
          {
            "parts": [{ "content": ")", "status": "ADDED" }],
            "oldN": 12,
            "newN": 12
          },
          {
            "parts": [
              { "content": "from ", "status": "UNCHANGED" },
              {
                "content": "upscale.v2.modules.user.inputs.user_language_profile_input",
                "status": "ADDED"
              },
              { "content": " import ", "status": "UNCHANGED" },
              { "content": "(", "status": "ADDED" }
            ],
            "oldN": 13,
            "newN": 13
          },
          {
            "parts": [
              { "content": "    UserLanguageProfileInput,", "status": "ADDED" }
            ],
            "oldN": 14,
            "newN": 14
          },
          {
            "parts": [{ "content": ")", "status": "ADDED" }],
            "oldN": 15,
            "newN": 15
          },
          {
            "parts": [
              { "content": "class ", "status": "UNCHANGED" },
              {
                "content": "UpdateUserInput(graphene.InputObjectType):",
                "status": "ADDED"
              }
            ],
            "oldN": 22,
            "newN": 22
          },
          {
            "parts": [
              {
                "content": "    address = graphene.Field(AddressInput)",
                "status": "ADDED"
              }
            ],
            "oldN": 23,
            "newN": 23
          },
          {
            "parts": [
              { "content": "    avatar = graphene.String()", "status": "ADDED" }
            ],
            "oldN": 24,
            "newN": 24
          },
          {
            "parts": [
              {
                "content": "    calendly_url = graphene.String()",
                "status": "ADDED"
              }
            ],
            "oldN": 25,
            "newN": 25
          },
          {
            "parts": [
              {
                "content": "    contact_order = graphene.List(",
                "status": "ADDED"
              }
            ],
            "oldN": 26,
            "newN": 26
          },
          {
            "parts": [
              {
                "content": "        ContactOrderValues, default_value=DEFAULT_CONTACT_ORDER",
                "status": "ADDED"
              }
            ],
            "oldN": 27,
            "newN": 27
          },
          {
            "parts": [{ "content": "    )", "status": "ADDED" }],
            "oldN": 28,
            "newN": 28
          },
          {
            "parts": [
              { "content": "    email = UpscaleEmail()", "status": "ADDED" }
            ],
            "oldN": 29,
            "newN": 29
          },
          {
            "parts": [
              {
                "content": "    facebook_id = graphene.String()",
                "status": "ADDED"
              }
            ],
            "oldN": 30,
            "newN": 30
          },
          {
            "parts": [
              {
                "content": "    instagram_id = graphene.String()",
                "status": "ADDED"
              }
            ],
            "oldN": 31,
            "newN": 31
          },
          {
            "parts": [
              {
                "content": "    line_id = graphene.String()",
                "status": "ADDED"
              }
            ],
            "oldN": 32,
            "newN": 32
          },
          {
            "parts": [
              {
                "content": "    linkedin_id = graphene.String()",
                "status": "ADDED"
              }
            ],
            "oldN": 33,
            "newN": 33
          },
          {
            "parts": [
              {
                "content": "    multi_language_profiles = graphene.List(UserLanguageProfileInput)",
                "status": "ADDED"
              }
            ],
            "oldN": 34,
            "newN": 34
          },
          {
            "parts": [
              {
                "content": "    personal_intro_id = graphene.String()",
                "status": "ADDED"
              }
            ],
            "oldN": 35,
            "newN": 35
          },
          {
            "parts": [
              { "content": "    phone = UpscalePhone()", "status": "ADDED" }
            ],
            "oldN": 36,
            "newN": 36
          },
          {
            "parts": [
              {
                "content": "    qualifications = graphene.String()",
                "status": "ADDED"
              }
            ],
            "oldN": 37,
            "newN": 37
          },
          {
            "parts": [
              {
                "content": "    role = UpscaleID(required=True)",
                "status": "ADDED"
              }
            ],
            "oldN": 38,
            "newN": 38
          },
          {
            "parts": [
              {
                "content": "    sale_team = UpscaleID(required=True)",
                "status": "ADDED"
              }
            ],
            "oldN": 39,
            "newN": 39
          },
          {
            "parts": [
              {
                "content": "    secondary_email = UpscaleEmail()",
                "status": "ADDED"
              }
            ],
            "oldN": 40,
            "newN": 40
          },
          {
            "parts": [
              {
                "content": "    secondary_phones = graphene.List(UpscalePhone, default=list)",
                "status": "ADDED"
              }
            ],
            "oldN": 41,
            "newN": 41
          },
          {
            "parts": [
              {
                "content": "    skype_id = graphene.String()",
                "status": "ADDED"
              }
            ],
            "oldN": 42,
            "newN": 42
          },
          {
            "parts": [
              {
                "content": "    status = StatusEnum(required=True, default=StatusEnum.ACTIVE)",
                "status": "ADDED"
              }
            ],
            "oldN": 43,
            "newN": 43
          },
          {
            "parts": [
              {
                "content": "    telegram_id = graphene.String()",
                "status": "ADDED"
              }
            ],
            "oldN": 44,
            "newN": 44
          },
          {
            "parts": [
              {
                "content": "    tiktok_id = graphene.String()",
                "status": "ADDED"
              }
            ],
            "oldN": 45,
            "newN": 45
          },
          {
            "parts": [
              {
                "content": "    username = graphene.String()",
                "status": "ADDED"
              }
            ],
            "oldN": 46,
            "newN": 46
          },
          {
            "parts": [
              {
                "content": "    viber_id = graphene.String()",
                "status": "ADDED"
              }
            ],
            "oldN": 47,
            "newN": 47
          },
          {
            "parts": [
              {
                "content": "    wechat_id = graphene.String()",
                "status": "ADDED"
              }
            ],
            "oldN": 48,
            "newN": 48
          },
          {
            "parts": [
              {
                "content": "    wechat_qr_id = graphene.String()",
                "status": "ADDED"
              }
            ],
            "oldN": 49,
            "newN": 49
          },
          {
            "parts": [
              {
                "content": "    whatsapp_id = UpscalePhone()",
                "status": "ADDED"
              }
            ],
            "oldN": 50,
            "newN": 50
          },
          {
            "parts": [
              {
                "content": "    zalo_id = graphene.String()",
                "status": "ADDED"
              }
            ],
            "oldN": 51,
            "newN": 51
          },
          {
            "parts": [
              {
                "content": "    temp_password = graphene.String()",
                "status": "ADDED"
              }
            ],
            "oldN": 52,
            "newN": 52
          }
        ]
      }
    ]
  },
  {
    "status": "MODIFIED",
    "displayPaths": [
      "upscale/v2/modules/user/mutations/notification_device_register.py"
    ],
    "oldPath": "upscale/v2/modules/user/mutations/notification_device_register.py",
    "newPath": "upscale/v2/modules/user/mutations/notification_device_register.py",
    "hunks": [
      {
        "oldLineCount": 6,
        "oldLineStart": 1,
        "newLineCount": 6,
        "newLineStart": 1,
        "beforeDiff": [
          {
            "parts": [
              { "content": "from ", "status": "UNCHANGED" },
              {
                "content": "upscale.services.sns.provider",
                "status": "REMOVED"
              },
              { "content": " import ", "status": "UNCHANGED" },
              { "content": "SNSProvider", "status": "REMOVED" }
            ],
            "oldN": 3,
            "newN": 3
          }
        ],
        "afterDiff": [
          {
            "parts": [
              { "content": "from ", "status": "UNCHANGED" },
              {
                "content": "upscale.v2.modules.user.bootstrap",
                "status": "ADDED"
              },
              { "content": " import ", "status": "UNCHANGED" },
              { "content": "bootstrap", "status": "ADDED" }
            ],
            "oldN": 3,
            "newN": 3
          }
        ]
      },
      {
        "enclosingBlock": "class NotificationDeviceRegister(graphene.Mutation):",
        "oldLineCount": 17,
        "oldLineStart": 10,
        "newLineCount": 7,
        "newLineStart": 10,
        "beforeDiff": [
          {
            "parts": [
              {
                "content": "    def mutate(cls, root, info, ",
                "status": "UNCHANGED"
              },
              { "content": "**args):", "status": "REMOVED" }
            ],
            "oldN": 13,
            "newN": 13
          },
          {
            "parts": [
              {
                "content": "        from upscale.v2.utils.request import get_current_user",
                "status": "REMOVED"
              }
            ],
            "oldN": 14,
            "newN": 14
          },
          {
            "parts": [{ "content": "        token", "status": "REMOVED" }],
            "oldN": 16,
            "newN": 16
          },
          {
            "parts": [
              { "content": " = ", "status": "UNCHANGED" },
              { "content": "args.get(\"token\")", "status": "REMOVED" }
            ],
            "oldN": 17,
            "newN": 17
          },
          {
            "parts": [
              {
                "content": "        sns_client = SNSProvider()",
                "status": "REMOVED"
              }
            ],
            "oldN": 18,
            "newN": 18
          },
          {
            "parts": [
              {
                "content": "        endpoint_arn = sns_client.create_platform_endpoint(token)",
                "status": "REMOVED"
              }
            ],
            "oldN": 19,
            "newN": 19
          },
          {
            "parts": [
              {
                "content": "        current_user = get_current_user()",
                "status": "REMOVED"
              }
            ],
            "oldN": 20,
            "newN": 20
          },
          {
            "parts": [
              {
                "content": "        if current_user.mobile_device_ids:",
                "status": "REMOVED"
              }
            ],
            "oldN": 21,
            "newN": 21
          },
          {
            "parts": [
              {
                "content": "            if endpoint_arn not in current_user.mobile_device_ids:",
                "status": "REMOVED"
              }
            ],
            "oldN": 22,
            "newN": 22
          },
          {
            "parts": [
              {
                "content": "                current_user.mobile_device_ids.append(endpoint_arn)",
                "status": "REMOVED"
              }
            ],
            "oldN": 23,
            "newN": 23
          },
          {
            "parts": [{ "content": "        else:", "status": "REMOVED" }],
            "oldN": 24,
            "newN": 24
          },
          {
            "parts": [
              {
                "content": "            current_user.mobile_device_ids = [endpoint_arn]",
                "status": "REMOVED"
              }
            ],
            "oldN": 25,
            "newN": 25
          },
          {
            "parts": [
              { "content": "        current_user.save()", "status": "REMOVED" }
            ],
            "oldN": 26,
            "newN": 26
          }
        ],
        "afterDiff": [
          {
            "parts": [{ "content": "token: str):", "status": "ADDED" }],
            "oldN": 16,
            "newN": 16
          },
          {
            "parts": [
              { "content": "        service", "status": "ADDED" },
              { "content": " = ", "status": "UNCHANGED" }
            ],
            "oldN": 17,
            "newN": 17
          },
          {
            "parts": [{ "content": "bootstrap()", "status": "ADDED" }],
            "oldN": 26,
            "newN": 26
          },
          {
            "parts": [
              {
                "content": "        service.register_device_id(token)",
                "status": "ADDED"
              }
            ],
            "oldN": 27,
            "newN": 27
          }
        ]
      }
    ]
  },
  {
    "status": "MODIFIED",
    "displayPaths": [
      "upscale/v2/modules/user/mutations/shorten_google_wallet_url.py"
    ],
    "oldPath": "upscale/v2/modules/user/mutations/shorten_google_wallet_url.py",
    "newPath": "upscale/v2/modules/user/mutations/shorten_google_wallet_url.py",
    "hunks": [
      {
        "oldLineCount": 8,
        "oldLineStart": 1,
        "newLineCount": 6,
        "newLineStart": 1,
        "beforeDiff": [
          {
            "parts": [
              { "content": "from ", "status": "UNCHANGED" },
              { "content": "upscale.utilities.utils", "status": "REMOVED" },
              { "content": " import ", "status": "UNCHANGED" },
              { "content": "get_shorten_url", "status": "REMOVED" }
            ],
            "oldN": 3,
            "newN": 3
          },
          {
            "parts": [
              {
                "content": "from upscale.v2.core.exceptions import UpscaleNotFoundException",
                "status": "REMOVED"
              }
            ],
            "oldN": 4,
            "newN": 4
          },
          {
            "parts": [
              {
                "content": "from upscale.v2.modules.user.service import UserService",
                "status": "REMOVED"
              }
            ],
            "oldN": 5,
            "newN": 5
          }
        ],
        "afterDiff": [
          {
            "parts": [
              { "content": "from ", "status": "UNCHANGED" },
              {
                "content": "upscale.v2.modules.user.bootstrap",
                "status": "ADDED"
              },
              { "content": " import ", "status": "UNCHANGED" }
            ],
            "oldN": 3,
            "newN": 3
          },
          {
            "parts": [{ "content": "bootstrap", "status": "ADDED" }],
            "oldN": 5,
            "newN": 5
          }
        ]
      },
      {
        "enclosingBlock": "class ShortenGoogleWalletUrl(graphene.Mutation):",
        "oldLineCount": 11,
        "oldLineStart": 12,
        "newLineCount": 7,
        "newLineStart": 10,
        "beforeDiff": [
          {
            "parts": [
              { "content": "        ", "status": "UNCHANGED" },
              { "content": "user", "status": "REMOVED" },
              { "content": " = ", "status": "UNCHANGED" },
              {
                "content": "UserService.get_by_id(id=user_id)",
                "status": "REMOVED"
              }
            ],
            "oldN": 15,
            "newN": 13
          },
          {
            "parts": [
              { "content": "        if user is None:", "status": "REMOVED" }
            ],
            "oldN": 16,
            "newN": 14
          },
          {
            "parts": [
              {
                "content": "            raise UpscaleNotFoundException()",
                "status": "REMOVED"
              }
            ],
            "oldN": 17,
            "newN": 15
          },
          {
            "parts": [
              {
                "content": "        if user.google_wallet_info is not None:",
                "status": "REMOVED"
              }
            ],
            "oldN": 18,
            "newN": 16
          },
          {
            "parts": [
              {
                "content": "            short_url = get_shorten_url(user.google_wallet_info)",
                "status": "REMOVED"
              }
            ],
            "oldN": 19,
            "newN": 17
          },
          {
            "parts": [
              {
                "content": "            if short_url is not None:",
                "status": "REMOVED"
              }
            ],
            "oldN": 20,
            "newN": 18
          },
          {
            "parts": [
              {
                "content": "                return ShortenGoogleWalletUrl(short_url=short_url)",
                "status": "REMOVED"
              }
            ],
            "oldN": 21,
            "newN": 19
          },
          {
            "parts": [
              { "content": "        return ", "status": "UNCHANGED" },
              {
                "content": "ShortenGoogleWalletUrl(short_url=user.google_wallet_info)",
                "status": "REMOVED"
              }
            ],
            "oldN": 22,
            "newN": 20
          }
        ],
        "afterDiff": [
          {
            "parts": [
              { "content": "        ", "status": "UNCHANGED" },
              { "content": "service", "status": "ADDED" },
              { "content": " = ", "status": "UNCHANGED" }
            ],
            "oldN": 15,
            "newN": 13
          },
          {
            "parts": [{ "content": "bootstrap()", "status": "ADDED" }],
            "oldN": 21,
            "newN": 19
          },
          {
            "parts": [
              { "content": "        return ", "status": "UNCHANGED" },
              { "content": "ShortenGoogleWalletUrl(", "status": "ADDED" }
            ],
            "oldN": 22,
            "newN": 20
          },
          {
            "parts": [
              {
                "content": "            short_url=service.shorten_google_wallet_url()",
                "status": "ADDED"
              }
            ],
            "oldN": 23,
            "newN": 21
          },
          {
            "parts": [{ "content": "        )", "status": "ADDED" }],
            "oldN": 24,
            "newN": 22
          }
        ]
      }
    ]
  },
  {
    "status": "MODIFIED",
    "displayPaths": ["upscale/v2/modules/user/query.py"],
    "oldPath": "upscale/v2/modules/user/query.py",
    "newPath": "upscale/v2/modules/user/query.py",
    "hunks": [
      {
        "oldLineCount": 21,
        "oldLineStart": 1,
        "newLineCount": 16,
        "newLineStart": 1,
        "beforeDiff": [
          {
            "parts": [
              {
                "content": "from pydash import objects  # type: ignore",
                "status": "REMOVED"
              }
            ],
            "oldN": 2,
            "newN": 2
          },
          {
            "parts": [
              {
                "content": "from upscale.v2.core.enums import OrderEnum, ",
                "status": "UNCHANGED"
              },
              {
                "content": "OrderFilterEnum, RoleTypeEnum",
                "status": "REMOVED"
              }
            ],
            "oldN": 4,
            "newN": 4
          },
          {
            "parts": [
              {
                "content": "from upscale.v2.core.exceptions import UpscaleNotAuthorizedException",
                "status": "REMOVED"
              }
            ],
            "oldN": 5,
            "newN": 5
          },
          {
            "parts": [
              {
                "content": "from upscale.v2.modules.role.service import RoleService",
                "status": "REMOVED"
              }
            ],
            "oldN": 9,
            "newN": 9
          },
          {
            "parts": [
              {
                "content": "from upscale.v2.modules.user.enums import RoleEnum",
                "status": "REMOVED"
              }
            ],
            "oldN": 12,
            "newN": 12
          },
          {
            "parts": [
              {
                "content": "from upscale.v2.modules.user.typedefs.user_profile import UserProfile",
                "status": "REMOVED"
              }
            ],
            "oldN": 18,
            "newN": 18
          }
        ],
        "afterDiff": [
          {
            "parts": [{ "content": "OrderFilterEnum", "status": "ADDED" }],
            "oldN": 5,
            "newN": 5
          }
        ]
      },
      {
        "enclosingBlock": "class Query(graphene.ObjectType):",
        "oldLineCount": 10,
        "oldLineStart": 55,
        "newLineCount": 11,
        "newLineStart": 50,
        "beforeDiff": [
          {
            "parts": [
              { "content": "    def ", "status": "UNCHANGED" },
              {
                "content": "resolve_videogen_api_key(self, info):",
                "status": "REMOVED"
              }
            ],
            "oldN": 59,
            "newN": 54
          }
        ],
        "afterDiff": [
          {
            "parts": [
              { "content": "    ", "status": "UNCHANGED" },
              { "content": "@staticmethod", "status": "ADDED" }
            ],
            "oldN": 58,
            "newN": 53
          },
          {
            "parts": [
              { "content": "    def ", "status": "UNCHANGED" },
              {
                "content": "resolve_videogen_api_key(root: \"Query\", _: graphene.ResolveInfo):",
                "status": "ADDED"
              }
            ],
            "oldN": 59,
            "newN": 54
          },
          {
            "parts": [
              { "content": "        )  ", "status": "UNCHANGED" },
              { "content": "# type: ignore", "status": "ADDED" }
            ],
            "oldN": 62,
            "newN": 57
          }
        ]
      }
    ]
  },
  {
    "status": "MODIFIED",
    "displayPaths": ["upscale/v2/modules/user/service_v2.py"],
    "oldPath": "upscale/v2/modules/user/service_v2.py",
    "newPath": "upscale/v2/modules/user/service_v2.py",
    "hunks": [
      {
        "oldLineCount": 8,
        "oldLineStart": 1,
        "newLineCount": 10,
        "newLineStart": 1,
        "beforeDiff": [],
        "afterDiff": [
          {
            "parts": [
              { "content": "from typing import Callable", "status": "ADDED" }
            ],
            "oldN": 3,
            "newN": 3
          },
          {
            "parts": [
              {
                "content": "from upscale.v2.aws.sns import AbstractSnsProvider",
                "status": "ADDED"
              }
            ],
            "oldN": 7,
            "newN": 7
          }
        ]
      },
      {
        "enclosingBlock": "from upscale.v2.modules.auth.domain import ROLES, RoleType",
        "oldLineCount": 7,
        "oldLineStart": 10,
        "newLineCount": 9,
        "newLineStart": 12,
        "beforeDiff": [],
        "afterDiff": [
          {
            "parts": [
              {
                "content": "from upscale.v2.modules.user.constants import DEFAULT_CONTACT_ORDER",
                "status": "ADDED"
              }
            ],
            "oldN": 13,
            "newN": 15
          },
          {
            "parts": [
              { "content": "    ", "status": "UNCHANGED" },
              { "content": "ContactChannel,", "status": "ADDED" }
            ],
            "oldN": 15,
            "newN": 17
          }
        ]
      },
      {
        "enclosingBlock": "from upscale.v2.modules.user.domain import (",
        "oldLineCount": 7,
        "oldLineStart": 18,
        "newLineCount": 7,
        "newLineStart": 22,
        "beforeDiff": [
          {
            "parts": [
              {
                "content": "from upscale.v2.modules.user.errors import ",
                "status": "UNCHANGED"
              },
              { "content": "CreateUserErrors", "status": "REMOVED" }
            ],
            "oldN": 21,
            "newN": 25
          }
        ],
        "afterDiff": [
          {
            "parts": [
              {
                "content": "from upscale.v2.modules.user.errors import ",
                "status": "UNCHANGED"
              },
              { "content": "PutUserErrors", "status": "ADDED" }
            ],
            "oldN": 21,
            "newN": 25
          }
        ]
      },
      {
        "enclosingBlock": "class UserService:",
        "oldLineCount": 8,
        "oldLineStart": 40,
        "newLineCount": 10,
        "newLineStart": 44,
        "beforeDiff": [],
        "afterDiff": [
          {
            "parts": [
              { "content": "        ", "status": "UNCHANGED" },
              {
                "content": "sns_provider: AbstractSnsProvider,",
                "status": "ADDED"
              }
            ],
            "oldN": 43,
            "newN": 47
          },
          {
            "parts": [
              { "content": "        ", "status": "UNCHANGED" },
              {
                "content": "url_shortener: Callable[[str], str],",
                "status": "ADDED"
              }
            ],
            "oldN": 46,
            "newN": 50
          }
        ]
      },
      {
        "enclosingBlock": "class UserService:",
        "oldLineCount": 20,
        "oldLineStart": 51,
        "newLineCount": 22,
        "newLineStart": 57,
        "beforeDiff": [
          {
            "parts": [
              {
                "content": "    def __validate_username(self, username: str) -> ",
                "status": "UNCHANGED"
              },
              { "content": "CreateUserErrors", "status": "REMOVED" },
              { "content": " | None:", "status": "UNCHANGED" }
            ],
            "oldN": 60,
            "newN": 66
          },
          {
            "parts": [
              { "content": "            return ", "status": "UNCHANGED" },
              {
                "content": "CreateUserErrors.USERNAME_TAKEN",
                "status": "REMOVED"
              }
            ],
            "oldN": 63,
            "newN": 69
          },
          {
            "parts": [
              { "content": "            return ", "status": "UNCHANGED" },
              {
                "content": "CreateUserErrors.USERNAME_TAKEN_IN_OTHER_ORG",
                "status": "REMOVED"
              }
            ],
            "oldN": 69,
            "newN": 75
          }
        ],
        "afterDiff": [
          {
            "parts": [
              { "content": "        ", "status": "UNCHANGED" },
              {
                "content": "self.sns_provider = sns_provider",
                "status": "ADDED"
              }
            ],
            "oldN": 54,
            "newN": 60
          },
          {
            "parts": [
              { "content": "        ", "status": "UNCHANGED" },
              {
                "content": "self.url_shortener = url_shortener",
                "status": "ADDED"
              }
            ],
            "oldN": 57,
            "newN": 63
          },
          {
            "parts": [
              {
                "content": "    def __validate_username(self, username: str) -> ",
                "status": "UNCHANGED"
              },
              { "content": "PutUserErrors", "status": "ADDED" },
              { "content": " | None:", "status": "UNCHANGED" }
            ],
            "oldN": 60,
            "newN": 66
          },
          {
            "parts": [
              { "content": "            return ", "status": "UNCHANGED" },
              { "content": "PutUserErrors.USERNAME_TAKEN", "status": "ADDED" }
            ],
            "oldN": 63,
            "newN": 69
          },
          {
            "parts": [
              { "content": "            return ", "status": "UNCHANGED" },
              {
                "content": "PutUserErrors.USERNAME_TAKEN_IN_OTHER_ORG",
                "status": "ADDED"
              }
            ],
            "oldN": 69,
            "newN": 75
          }
        ]
      },
      {
        "enclosingBlock": "class UserService:",
        "oldLineCount": 9,
        "oldLineStart": 95,
        "newLineCount": 6,
        "newLineStart": 103,
        "beforeDiff": [
          {
            "parts": [
              {
                "content": "        if email is None and username is None and phone is None:",
                "status": "REMOVED"
              }
            ],
            "oldN": 98,
            "newN": 106
          },
          {
            "parts": [
              {
                "content": "            raise UpsException(CreateUserErrors.USERNAME_REQUIRED)",
                "status": "REMOVED"
              }
            ],
            "oldN": 99,
            "newN": 107
          }
        ],
        "afterDiff": []
      },
      {
        "enclosingBlock": "class UserService:",
        "oldLineCount": 3,
        "oldLineStart": 407,
        "newLineCount": 85,
        "newLineStart": 412,
        "beforeDiff": [],
        "afterDiff": [
          {
            "parts": [
              { "content": "    ", "status": "UNCHANGED" },
              {
                "content": "def register_device_id(self, token: str) -> None:",
                "status": "ADDED"
              }
            ],
            "oldN": 411,
            "newN": 416
          },
          {
            "parts": [
              {
                "content": "        current_user = self.auth_provider.expect_authenticated_user()",
                "status": "ADDED"
              }
            ],
            "oldN": 412,
            "newN": 417
          },
          {
            "parts": [
              {
                "content": "        endpoint_arn = self.sns_provider.create_platform_endpoint(token)",
                "status": "ADDED"
              }
            ],
            "oldN": 413,
            "newN": 418
          },
          {
            "parts": [
              {
                "content": "        current_user.mobile_device_ids.append(endpoint_arn)",
                "status": "ADDED"
              }
            ],
            "oldN": 415,
            "newN": 420
          },
          {
            "parts": [
              {
                "content": "        self.user_repository.put(current_user)",
                "status": "ADDED"
              }
            ],
            "oldN": 416,
            "newN": 421
          },
          {
            "parts": [
              {
                "content": "    def shorten_google_wallet_url(self) -> str | None:",
                "status": "ADDED"
              }
            ],
            "oldN": 418,
            "newN": 423
          },
          {
            "parts": [
              {
                "content": "        current_user = self.auth_provider.expect_authenticated_user()",
                "status": "ADDED"
              }
            ],
            "oldN": 419,
            "newN": 424
          },
          {
            "parts": [
              {
                "content": "        if current_user.google_wallet_info is None:",
                "status": "ADDED"
              }
            ],
            "oldN": 420,
            "newN": 425
          },
          {
            "parts": [
              { "content": "            return None", "status": "ADDED" }
            ],
            "oldN": 421,
            "newN": 426
          },
          {
            "parts": [
              {
                "content": "        return self.url_shortener(current_user.google_wallet_info)",
                "status": "ADDED"
              }
            ],
            "oldN": 422,
            "newN": 427
          },
          {
            "parts": [{ "content": "    def update_user(", "status": "ADDED" }],
            "oldN": 424,
            "newN": 429
          },
          {
            "parts": [{ "content": "        self,", "status": "ADDED" }],
            "oldN": 425,
            "newN": 430
          },
          {
            "parts": [
              { "content": "        user_id: str,", "status": "ADDED" }
            ],
            "oldN": 426,
            "newN": 431
          },
          {
            "parts": [
              {
                "content": "        address: Address | None,",
                "status": "ADDED"
              }
            ],
            "oldN": 427,
            "newN": 432
          },
          {
            "parts": [
              { "content": "        avatar_id: str | None,", "status": "ADDED" }
            ],
            "oldN": 428,
            "newN": 433
          },
          {
            "parts": [
              {
                "content": "        contact_order: list[ContactChannel],",
                "status": "ADDED"
              }
            ],
            "oldN": 429,
            "newN": 434
          },
          {
            "parts": [
              { "content": "        email: str | None,", "status": "ADDED" }
            ],
            "oldN": 430,
            "newN": 435
          },
          {
            "parts": [
              {
                "content": "        localized_profiles: list[UserLocalizedProfile],",
                "status": "ADDED"
              }
            ],
            "oldN": 431,
            "newN": 436
          },
          {
            "parts": [
              {
                "content": "        personal_intro_id: str | None,",
                "status": "ADDED"
              }
            ],
            "oldN": 432,
            "newN": 437
          },
          {
            "parts": [
              { "content": "        phone: str | None,", "status": "ADDED" }
            ],
            "oldN": 433,
            "newN": 438
          },
          {
            "parts": [
              {
                "content": "        qualifications: str | None,",
                "status": "ADDED"
              }
            ],
            "oldN": 434,
            "newN": 439
          },
          {
            "parts": [
              { "content": "        role_id: str,", "status": "ADDED" }
            ],
            "oldN": 435,
            "newN": 440
          },
          {
            "parts": [
              {
                "content": "        secondary_email: str | None,",
                "status": "ADDED"
              }
            ],
            "oldN": 436,
            "newN": 441
          },
          {
            "parts": [
              {
                "content": "        secondary_phones: list[str],",
                "status": "ADDED"
              }
            ],
            "oldN": 437,
            "newN": 442
          },
          {
            "parts": [
              { "content": "        socials: UserSocials,", "status": "ADDED" }
            ],
            "oldN": 438,
            "newN": 443
          },
          {
            "parts": [
              { "content": "        status: bool,", "status": "ADDED" }
            ],
            "oldN": 439,
            "newN": 444
          },
          {
            "parts": [
              { "content": "        team_id: str,", "status": "ADDED" }
            ],
            "oldN": 440,
            "newN": 445
          },
          {
            "parts": [
              {
                "content": "        temp_password: str | None,",
                "status": "ADDED"
              }
            ],
            "oldN": 441,
            "newN": 446
          },
          {
            "parts": [
              { "content": "        username: str | None,", "status": "ADDED" }
            ],
            "oldN": 442,
            "newN": 447
          },
          {
            "parts": [{ "content": "    ):", "status": "ADDED" }],
            "oldN": 443,
            "newN": 448
          },
          {
            "parts": [
              {
                "content": "        auth_infos = self.auth_provider.expect_authenticated_infos()",
                "status": "ADDED"
              }
            ],
            "oldN": 444,
            "newN": 449
          },
          {
            "parts": [{ "content": "        if (", "status": "ADDED" }],
            "oldN": 446,
            "newN": 451
          },
          {
            "parts": [
              {
                "content": "            auth_infos.is_superuser is False",
                "status": "ADDED"
              }
            ],
            "oldN": 447,
            "newN": 452
          },
          {
            "parts": [
              {
                "content": "            and auth_infos.is_branch_admin is False",
                "status": "ADDED"
              }
            ],
            "oldN": 448,
            "newN": 453
          },
          {
            "parts": [{ "content": "        ):", "status": "ADDED" }],
            "oldN": 449,
            "newN": 454
          },
          {
            "parts": [
              {
                "content": "            raise UpsException(CommonExceptions.UNAUTHORIZED)",
                "status": "ADDED"
              }
            ],
            "oldN": 450,
            "newN": 455
          },
          {
            "parts": [
              {
                "content": "        user_to_update = self.user_repository.get(user_id)",
                "status": "ADDED"
              }
            ],
            "oldN": 452,
            "newN": 457
          },
          {
            "parts": [{ "content": "        if (", "status": "ADDED" }],
            "oldN": 454,
            "newN": 459
          },
          {
            "parts": [
              {
                "content": "            auth_infos.is_branch_admin",
                "status": "ADDED"
              }
            ],
            "oldN": 455,
            "newN": 460
          },
          {
            "parts": [
              {
                "content": "            and user_to_update.branch_id != auth_infos.branch_id",
                "status": "ADDED"
              }
            ],
            "oldN": 456,
            "newN": 461
          },
          {
            "parts": [{ "content": "        ):", "status": "ADDED" }],
            "oldN": 457,
            "newN": 462
          },
          {
            "parts": [
              {
                "content": "            raise UpsException(CommonExceptions.UNAUTHORIZED)",
                "status": "ADDED"
              }
            ],
            "oldN": 458,
            "newN": 463
          },
          {
            "parts": [
              {
                "content": "        if email is not None and email != user_to_update.email:",
                "status": "ADDED"
              }
            ],
            "oldN": 460,
            "newN": 465
          },
          {
            "parts": [
              {
                "content": "            error = self.__validate_username(email)",
                "status": "ADDED"
              }
            ],
            "oldN": 461,
            "newN": 466
          },
          {
            "parts": [
              {
                "content": "            if error is not None:",
                "status": "ADDED"
              }
            ],
            "oldN": 462,
            "newN": 467
          },
          {
            "parts": [
              {
                "content": "                raise UpsException(error)",
                "status": "ADDED"
              }
            ],
            "oldN": 463,
            "newN": 468
          },
          {
            "parts": [
              {
                "content": "        if phone is not None and phone != user_to_update.phone:",
                "status": "ADDED"
              }
            ],
            "oldN": 465,
            "newN": 470
          },
          {
            "parts": [
              {
                "content": "            error = self.__validate_username(phone)",
                "status": "ADDED"
              }
            ],
            "oldN": 466,
            "newN": 471
          },
          {
            "parts": [
              {
                "content": "            if error is not None:",
                "status": "ADDED"
              }
            ],
            "oldN": 467,
            "newN": 472
          },
          {
            "parts": [
              {
                "content": "                raise UpsException(error)",
                "status": "ADDED"
              }
            ],
            "oldN": 468,
            "newN": 473
          },
          {
            "parts": [
              {
                "content": "        if username is not None and username != user_to_update.username:",
                "status": "ADDED"
              }
            ],
            "oldN": 470,
            "newN": 475
          },
          {
            "parts": [
              {
                "content": "            error = self.__validate_username(username)",
                "status": "ADDED"
              }
            ],
            "oldN": 471,
            "newN": 476
          },
          {
            "parts": [
              {
                "content": "            if error is not None:",
                "status": "ADDED"
              }
            ],
            "oldN": 472,
            "newN": 477
          },
          {
            "parts": [
              {
                "content": "                raise UpsException(error)",
                "status": "ADDED"
              }
            ],
            "oldN": 473,
            "newN": 478
          },
          {
            "parts": [
              {
                "content": "        verified_address = address",
                "status": "ADDED"
              }
            ],
            "oldN": 475,
            "newN": 480
          },
          {
            "parts": [
              {
                "content": "        if address and address != user_to_update.address:",
                "status": "ADDED"
              }
            ],
            "oldN": 476,
            "newN": 481
          },
          {
            "parts": [
              { "content": "            coordinates = (", "status": "ADDED" }
            ],
            "oldN": 477,
            "newN": 482
          },
          {
            "parts": [
              {
                "content": "                self.maps_provider.get_coordinates_from_address_string(",
                "status": "ADDED"
              }
            ],
            "oldN": 478,
            "newN": 483
          },
          {
            "parts": [
              {
                "content": "                    str(address)",
                "status": "ADDED"
              }
            ],
            "oldN": 479,
            "newN": 484
          },
          {
            "parts": [{ "content": "                )", "status": "ADDED" }],
            "oldN": 480,
            "newN": 485
          },
          {
            "parts": [{ "content": "            )", "status": "ADDED" }],
            "oldN": 481,
            "newN": 486
          },
          {
            "parts": [
              {
                "content": "            verified_address = address.verify(coordinates)",
                "status": "ADDED"
              }
            ],
            "oldN": 482,
            "newN": 487
          },
          {
            "parts": [{ "content": "        team = None", "status": "ADDED" }],
            "oldN": 484,
            "newN": 489
          },
          {
            "parts": [
              { "content": "        branch = None", "status": "ADDED" }
            ],
            "oldN": 485,
            "newN": 490
          },
          {
            "parts": [
              {
                "content": "        if team_id != str(user_to_update.team_id):",
                "status": "ADDED"
              }
            ],
            "oldN": 486,
            "newN": 491
          },
          {
            "parts": [
              {
                "content": "            team = self.team_repository.get(team_id)",
                "status": "ADDED"
              }
            ],
            "oldN": 487,
            "newN": 492
          },
          {
            "parts": [
              {
                "content": "            branch = self.branch_repository.get(str(team.branch_id))",
                "status": "ADDED"
              }
            ],
            "oldN": 488,
            "newN": 493
          },
          {
            "parts": [
              {
                "content": "        role = list(filter(lambda x: str(x.id) == role_id, ROLES.values()))[0]",
                "status": "ADDED"
              }
            ],
            "oldN": 490,
            "newN": 495
          },
          {
            "parts": [
              {
                "content": "        updated_user = user_to_update.update()",
                "status": "ADDED"
              }
            ],
            "oldN": 491,
            "newN": 496
          }
        ]
      }
    ]
  },
  {
    "status": "MODIFIED",
    "displayPaths": ["upscale/v2/modules/user/tests/test_create_user.py"],
    "oldPath": "upscale/v2/modules/user/tests/test_create_user.py",
    "newPath": "upscale/v2/modules/user/tests/test_create_user.py",
    "hunks": [
      {
        "enclosingBlock": "from upscale.v2.modules.auth.provider import AuthFakeProvider",
        "oldLineCount": 7,
        "oldLineStart": 8,
        "newLineCount": 7,
        "newLineStart": 8,
        "beforeDiff": [
          {
            "parts": [
              {
                "content": "from upscale.v2.modules.user.errors import ",
                "status": "UNCHANGED"
              },
              { "content": "CreateUserErrors", "status": "REMOVED" }
            ],
            "oldN": 11,
            "newN": 11
          }
        ],
        "afterDiff": [
          {
            "parts": [
              {
                "content": "from upscale.v2.modules.user.errors import ",
                "status": "UNCHANGED"
              },
              { "content": "PutUserErrors", "status": "ADDED" }
            ],
            "oldN": 11,
            "newN": 11
          }
        ]
      },
      {
        "enclosingBlock": "def test_create_user_expects_phone_email_or_username(",
        "oldLineCount": 7,
        "oldLineStart": 148,
        "newLineCount": 7,
        "newLineStart": 148,
        "beforeDiff": [
          {
            "parts": [
              { "content": "        assert ", "status": "UNCHANGED" },
              {
                "content": "CreateUserErrors.USERNAME_REQUIRED.description",
                "status": "REMOVED"
              },
              { "content": " in str(e)", "status": "UNCHANGED" }
            ],
            "oldN": 151,
            "newN": 151
          }
        ],
        "afterDiff": [
          {
            "parts": [
              { "content": "        assert ", "status": "UNCHANGED" },
              {
                "content": "PutUserErrors.USERNAME_REQUIRED.description",
                "status": "ADDED"
              },
              { "content": " in str(e)", "status": "UNCHANGED" }
            ],
            "oldN": 151,
            "newN": 151
          }
        ]
      },
      {
        "enclosingBlock": "def test_create_user_rejects_existing_username(user_factory):",
        "oldLineCount": 7,
        "oldLineStart": 192,
        "newLineCount": 7,
        "newLineStart": 192,
        "beforeDiff": [
          {
            "parts": [
              { "content": "        assert ", "status": "UNCHANGED" },
              {
                "content": "CreateUserErrors.USERNAME_TAKEN.description",
                "status": "REMOVED"
              },
              { "content": " in str(e)", "status": "UNCHANGED" }
            ],
            "oldN": 195,
            "newN": 195
          }
        ],
        "afterDiff": [
          {
            "parts": [
              { "content": "        assert ", "status": "UNCHANGED" },
              {
                "content": "PutUserErrors.USERNAME_TAKEN.description",
                "status": "ADDED"
              },
              { "content": " in str(e)", "status": "UNCHANGED" }
            ],
            "oldN": 195,
            "newN": 195
          }
        ]
      },
      {
        "enclosingBlock": "def test_create_user_rejects_existing_username(user_factory):",
        "oldLineCount": 7,
        "oldLineStart": 211,
        "newLineCount": 7,
        "newLineStart": 211,
        "beforeDiff": [
          {
            "parts": [
              { "content": "        assert ", "status": "UNCHANGED" },
              {
                "content": "CreateUserErrors.USERNAME_TAKEN.description",
                "status": "REMOVED"
              },
              { "content": " in str(e)", "status": "UNCHANGED" }
            ],
            "oldN": 214,
            "newN": 214
          }
        ],
        "afterDiff": [
          {
            "parts": [
              { "content": "        assert ", "status": "UNCHANGED" },
              {
                "content": "PutUserErrors.USERNAME_TAKEN.description",
                "status": "ADDED"
              },
              { "content": " in str(e)", "status": "UNCHANGED" }
            ],
            "oldN": 214,
            "newN": 214
          }
        ]
      },
      {
        "enclosingBlock": "def test_create_user_rejects_existing_username(user_factory):",
        "oldLineCount": 7,
        "oldLineStart": 230,
        "newLineCount": 7,
        "newLineStart": 230,
        "beforeDiff": [
          {
            "parts": [
              { "content": "        assert ", "status": "UNCHANGED" },
              {
                "content": "CreateUserErrors.USERNAME_TAKEN.description",
                "status": "REMOVED"
              },
              { "content": " in str(e)", "status": "UNCHANGED" }
            ],
            "oldN": 233,
            "newN": 233
          }
        ],
        "afterDiff": [
          {
            "parts": [
              { "content": "        assert ", "status": "UNCHANGED" },
              {
                "content": "PutUserErrors.USERNAME_TAKEN.description",
                "status": "ADDED"
              },
              { "content": " in str(e)", "status": "UNCHANGED" }
            ],
            "oldN": 233,
            "newN": 233
          }
        ]
      },
      {
        "enclosingBlock": "def test_create_user_rejects_existing_username_in_other_org(user_factory):",
        "oldLineCount": 7,
        "oldLineStart": 279,
        "newLineCount": 7,
        "newLineStart": 279,
        "beforeDiff": [
          {
            "parts": [
              { "content": "        assert ", "status": "UNCHANGED" },
              {
                "content": "CreateUserErrors.USERNAME_TAKEN.description",
                "status": "REMOVED"
              },
              { "content": " in str(e)", "status": "UNCHANGED" }
            ],
            "oldN": 282,
            "newN": 282
          }
        ],
        "afterDiff": [
          {
            "parts": [
              { "content": "        assert ", "status": "UNCHANGED" },
              {
                "content": "PutUserErrors.USERNAME_TAKEN.description",
                "status": "ADDED"
              },
              { "content": " in str(e)", "status": "UNCHANGED" }
            ],
            "oldN": 282,
            "newN": 282
          }
        ]
      }
    ]
  }
]
